as a script
Exception in thread Profile:
Traceback (most recent call last):
  File "/nobackup/amondal/.conda/envs/xmitgcm4/lib/python3.10/site-packages/distributed/profile.py", line 115, in process
    d = state["children"][ident]
KeyError: '_propagate_forgotten;/nobackup/amondal/.conda/envs/xmitgcm4/lib/python3.10/site-packages/distributed/scheduler.py;7945'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/nobackup/amondal/.conda/envs/xmitgcm4/lib/python3.10/threading.py", line 1009, in _bootstrap_inner
    self.run()
  File "/nobackup/amondal/.conda/envs/xmitgcm4/lib/python3.10/threading.py", line 946, in run
    self._target(*self._args, **self._kwargs)
  File "/nobackup/amondal/.conda/envs/xmitgcm4/lib/python3.10/site-packages/distributed/profile.py", line 274, in _watch
    process(frame, None, recent, omit=omit)
  File "/nobackup/amondal/.conda/envs/xmitgcm4/lib/python3.10/site-packages/distributed/profile.py", line 119, in process
    "description": info_frame(frame),
  File "/nobackup/amondal/.conda/envs/xmitgcm4/lib/python3.10/site-packages/distributed/profile.py", line 72, in info_fame
    line = linecache.getline(co.co_filename, frame.f_lineno, frame.f_globals).lstrip()
  File "/nobackup/amondal/.conda/envs/xmitgcm4/lib/python3.10/linecache.py", line 31, in getline
    if 1 <= lineno <= len(lines):
TypeError: '<=' not supported between instances of 'int' and 'NoneType'
Exception in thread Profile:
Traceback (most recent call last):
  File "/nobackup/amondal/.conda/envs/xmitgcm4/lib/python3.10/site-packages/distributed/profile.py", line 115, in process
    d = state["children"][ident]
KeyError: 'transition_generic_released;/nobackup/amondal/.conda/envs/xmitgcm4/lib/python3.10/site-packages/distributed/worker.py;2046'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/nobackup/amondal/.conda/envs/xmitgcm4/lib/python3.10/threading.py", line 1009, in _bootstrap_inner
    self.run()
  File "/nobackup/amondal/.conda/envs/xmitgcm4/lib/python3.10/threading.py", line 946, in run
    self._target(*self._args, **self._kwargs)
  File "/nobackup/amondal/.conda/envs/xmitgcm4/lib/python3.10/site-packages/distributed/profile.py", line 274, in _watch
    process(frame, None, recent, omit=omit)
  File "/nobackup/amondal/.conda/envs/xmitgcm4/lib/python3.10/site-packages/distributed/profile.py", line 119, in process
    "description": info_frame(frame),
  File "/nobackup/amondal/.conda/envs/xmitgcm4/lib/python3.10/site-packages/distributed/profile.py", line 72, in info_frame
    line = linecache.getline(co.co_filename, frame.f_lineno, frame.f_globals).lstrip()
  File "/nobackup/amondal/.conda/envs/xmitgcm4/lib/python3.10/linecache.py", line 31, in getline
    if 1 <= lineno <= len(lines):
TypeError: '<=' not supported between instances of 'int' and 'NoneType'
distributed.utils_perf - WARNING - full garbage collections took 10% CPU time recently (threshold: 10%)
distributed.utils_perf - WARNING - full garbage collections took 10% CPU time recently (threshold: 10%)
distributed.utils_perf - WARNING - full garbage collections took 10% CPU time recently (threshold: 10%)
distributed.utils_perf - WARNING - full garbage collections took 10% CPU time recently (threshold: 10%)
distributed.utils_perf - WARNING - full garbage collections took 10% CPU time recently (threshold: 10%)
distributed.utils_perf - WARNING - full garbage collections took 10% CPU time recently (threshold: 10%)
distributed.utils_perf - WARNING - full garbage collections took 10% CPU time recently (threshold: 10%)
distributed.utils_perf - WARNING - full garbage collections took 10% CPU time recently (threshold: 10%)
distributed.utils_perf - WARNING - full garbage collections took 10% CPU time recently (threshold: 10%)
distributed.utils_perf - WARNING - full garbage collections took 11% CPU time recently (threshold: 10%)
distributed.utils_perf - WARNING - full garbage collections took 11% CPU time recently (threshold: 10%)
distributed.utils_perf - WARNING - full garbage collections took 11% CPU time recently (threshold: 10%)
distributed.utils_perf - WARNING - full garbage collections took 11% CPU time recently (threshold: 10%)
distributed.utils_perf - WARNING - full garbage collections took 11% CPU time recently (threshold: 10%)
distributed.utils_perf - WARNING - full garbage collections took 11% CPU time recently (threshold: 10%)
distributed.utils_perf - WARNING - full garbage collections took 11% CPU time recently (threshold: 10%)
distributed.utils_perf - WARNING - full garbage collections took 11% CPU time recently (threshold: 10%)
distributed.utils_perf - WARNING - full garbage collections took 11% CPU time recently (threshold: 10%)
distributed.utils_perf - WARNING - full garbage collections took 10% CPU time recently (threshold: 10%)
distributed.utils_perf - WARNING - full garbage collections took 11% CPU time recently (threshold: 10%)
distributed.utils_perf - WARNING - full garbage collections took 11% CPU time recently (threshold: 10%)
Hector script has been loaded
Output directory is going to be an input parameter
Date and location has been set
Entering MIT_xr_date_location
date
[datetime.datetime(2020, 3, 1, 0, 0) datetime.datetime(2020, 3, 1, 1, 0)
 datetime.datetime(2020, 3, 1, 2, 0) ...
 datetime.datetime(2020, 5, 31, 22, 0)
 datetime.datetime(2020, 5, 31, 23, 0) datetime.datetime(2020, 6, 1, 0, 0)]

[ 78880.  78960.  79040. ... 255360. 255440. 255520.]

setting location
location
Directory of files
/nobackupp11/dmenemen/DYAMOND/c1440_llc2160/mit_output/Theta
before mds
grid xgcm.Grid
initialize mapping to GEOS grid
==== Folder to be created =======
/nobackup/amondal/NCData/20211103_multicoretest_3month_noland/HAdv_40
open files
78880.0
map field
mapped
save output
finished day 00
6.620513439178467
open files
78960.0
map field
mapped
save output
finished day 01
6.729585886001587
open files
79040.0
map field
mapped
save output
finished day 02
6.8053576946258545
open files
79120.0
map field
mapped
save output
finished day 03
7.055013418197632
open files
79200.0
map field
mapped
save output
finished day 04
6.811676740646362
open files
79280.0
map field
mapped
save output
finished day 05
6.901389122009277
open files
79360.0
map field
mapped
save output
finished day 06
7.162872076034546
open files
79440.0
map field
mapped
save output
finished day 07
7.147160768508911
open files
79520.0
map field
mapped
save output
finished day 08
6.434553623199463
open files
79600.0
map field
mapped
save output
finished day 09
7.0239245891571045
open files
79680.0
map field
mapped
save output
finished day 10
6.991453647613525
open files
79760.0
map field
mapped
save output
finished day 11
6.5188658237457275
open files
79840.0
map field
mapped
save output
finished day 12
6.69481635093689
open files
79920.0
map field
mapped
save output
finished day 13
6.383013010025024
open files
80000.0
map field
mapped
save output
finished day 14
7.8458685874938965
open files
80080.0
map field
mapped
save output
finished day 15
6.8682966232299805
open files
80160.0
map field
mapped
save output
finished day 16
6.893616676330566
open files
80240.0
map field
mapped
save output
finished day 17
6.348495721817017
open files
80320.0
map field
mapped
save output
finished day 18
6.358418226242065
open files
80400.0
map field
mapped
save output
finished day 19
6.128572463989258
open files
80480.0
map field
mapped
save output
finished day 20
6.529682397842407
open files
80560.0
map field
mapped
save output
finished day 21
6.986598253250122
open files
80640.0
map field
mapped
save output
finished day 22
6.577656984329224
open files
80720.0
map field
mapped
save output
finished day 23
8.14129090309143
open files
80800.0
map field
mapped
save output
finished day 24
6.5881898403167725
open files
80880.0
map field
mapped
save output
finished day 25
6.047947883605957
open files
80960.0
map field
mapped
save output
finished day 26
7.1609437465667725
open files
81040.0
map field
mapped
save output
finished day 27
6.630042552947998
open files
81120.0
map field
mapped
save output
finished day 28
6.722267389297485
open files
81200.0
map field
mapped
save output
finished day 29
6.679987192153931
open files
81280.0
map field
mapped
save output
finished day 30
6.73675274848938
open files
81360.0
map field
mapped
save output
finished day 31
7.446434736251831
open files
81440.0
map field
mapped
save output
finished day 32
7.210785150527954
open files
81520.0
map field
mapped
save output
finished day 33
6.8937294483184814
open files
81600.0
map field
mapped
save output
finished day 34
6.750776052474976
open files
81680.0
map field
mapped
save output
finished day 35
6.537601709365845
open files
81760.0
map field
mapped
save output
finished day 36
6.37510871887207
open files
81840.0
map field
mapped
save output
finished day 37
7.077038764953613
open files
81920.0
map field
mapped
save output
finished day 38
6.772184133529663
open files
82000.0
map field
mapped
save output
finished day 39
6.761034727096558
open files
82080.0
map field
mapped
save output
Traceback (most recent call last):
  File "/nobackup/amondal/.conda/envs/xmitgcm4/lib/python3.10/site-packages/xarray/backends/file_manager.py", line 199, in _acquire_with_cache_info
    file = self._cache[self._key]
  File "/nobackup/amondal/.conda/envs/xmitgcm4/lib/python3.10/site-packages/xarray/backends/lru_cache.py", line 53, in __getitem__
    value = self._cache[key]
KeyError: [<class 'netCDF4._netCDF4.Dataset'>, ('/nobackup/amondal/NCData/20211103_multicoretest_3month_noland/HAdv_40/HAdv_2020030216.nc',), 'a', (('clobber', True), ('diskless', False), ('format', 'NETCDF4'), ('persist', False))]

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/nobackupp12/amondal/Python/mit_geos_analysis/script18_repull_3month.py", line 95, in <module>
    MIT_xr_date_location_fol('HAdv',level,ffilter,fsize,y1,m1,d1,h1,M1,y2,m2,d2,h2,M2,lat1,lat2,latinc,lon1,lon2,loninc,fol)
  File "/nobackup/amondal/Python/Hector_Python_Scripts/MIT_xr_cwt_dateloc_fol.py", line 338, in MIT_xr_date_location_fol
    output.rename(VAR).to_netcdf(dirout+'/'+VAR+'_'+date[i].strftime("%Y%m%d%H")+'.nc')
  File "/nobackup/amondal/.conda/envs/xmitgcm4/lib/python3.10/site-packages/xarray/core/dataarray.py", line 2839, in to_netcdf
    return dataset.to_netcdf(*args, **kwargs)
  File "/nobackup/amondal/.conda/envs/xmitgcm4/lib/python3.10/site-packages/xarray/core/dataset.py", line 1902, in to_netcdf
    return to_netcdf(
  File "/nobackup/amondal/.conda/envs/xmitgcm4/lib/python3.10/site-packages/xarray/backends/api.py", line 1055, in to_netcdf
    store = store_open(target, mode, format, group, **kwargs)
  File "/nobackup/amondal/.conda/envs/xmitgcm4/lib/python3.10/site-packages/xarray/backends/netCDF4_.py", line 379, in open
    return cls(manager, group=group, mode=mode, lock=lock, autoclose=autoclose)
  File "/nobackup/amondal/.conda/envs/xmitgcm4/lib/python3.10/site-packages/xarray/backends/netCDF4_.py", line 327, in __init__
    self.format = self.ds.data_model
  File "/nobackup/amondal/.conda/envs/xmitgcm4/lib/python3.10/site-packages/xarray/backends/netCDF4_.py", line 388, in ds
    return self._acquire()
  File "/nobackup/amondal/.conda/envs/xmitgcm4/lib/python3.10/site-packages/xarray/backends/netCDF4_.py", line 382, in _acquire
    with self._manager.acquire_context(needs_lock) as root:
  File "/nobackup/amondal/.conda/envs/xmitgcm4/lib/python3.10/contextlib.py", line 135, in __enter__
    return next(self.gen)
  File "/nobackup/amondal/.conda/envs/xmitgcm4/lib/python3.10/site-packages/xarray/backends/file_manager.py", line 187, in acquire_context
    file, cached = self._acquire_with_cache_info(needs_lock)
  File "/nobackup/amondal/.conda/envs/xmitgcm4/lib/python3.10/site-packages/xarray/backends/file_manager.py", line 205, in _acquire_with_cache_info
    file = self._opener(*self._args, **kwargs)
  File "src/netCDF4/_netCDF4.pyx", line 2307, in netCDF4._netCDF4.Dataset.__init__
  File "src/netCDF4/_netCDF4.pyx", line 1925, in netCDF4._netCDF4._ensure_nc_success
PermissionError: [Errno 13] Permission denied: b'/nobackup/amondal/NCData/20211103_multicoretest_3month_noland/HAdv_40/HAdv_2020030216.nc'
as a script
Exception in thread Profile:
Traceback (most recent call last):
  File "/nobackup/amondal/.conda/envs/xmitgcm4/lib/python3.10/site-packages/distributed/profile.py", line 115, in process
    d = state["children"][ident]
KeyError: 'transition_generic_released;/nobackup/amondal/.conda/envs/xmitgcm4/lib/python3.10/site-packages/distributed/worker.py;2046'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/nobackup/amondal/.conda/envs/xmitgcm4/lib/python3.10/threading.py", line 1009, in _bootstrap_inner
    self.run()
  File "/nobackup/amondal/.conda/envs/xmitgcm4/lib/python3.10/threading.py", line 946, in run
    self._target(*self._args, **self._kwargs)
  File "/nobackup/amondal/.conda/envs/xmitgcm4/lib/python3.10/site-packages/distributed/profile.py", line 274, in _watch
    process(frame, None, recent, omit=omit)
  File "/nobackup/amondal/.conda/envs/xmitgcm4/lib/python3.10/site-packages/distributed/profile.py", line 119, in process
    "description": info_frame(frame),
  File "/nobackup/amondal/.conda/envs/xmitgcm4/lib/python3.10/site-packages/distributed/profile.py", line 72, in info_frame
    line = linecache.getline(co.co_filename, frame.f_lineno, frame.f_globals).lstrip()
  File "/nobackup/amondal/.conda/envs/xmitgcm4/lib/python3.10/linecache.py", line 31, in getline
    if 1 <= lineno <= len(lines):
TypeError: '<=' not supported between instances of 'int' and 'NoneType'
Exception in thread Profile:
Traceback (most recent call last):
  File "/nobackup/amondal/.conda/envs/xmitgcm4/lib/python3.10/site-packages/distributed/profile.py", line 115, in process
    d = state["children"][ident]
KeyError: '_propagate_forgotten;/nobackup/amondal/.conda/envs/xmitgcm4/lib/python3.10/site-packages/distributed/scheduler.py;7945'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/nobackup/amondal/.conda/envs/xmitgcm4/lib/python3.10/threading.py", line 1009, in _bootstrap_inner
    self.run()
  File "/nobackup/amondal/.conda/envs/xmitgcm4/lib/python3.10/threading.py", line 946, in run
    self._target(*self._args, **self._kwargs)
  File "/nobackup/amondal/.conda/envs/xmitgcm4/lib/python3.10/site-packages/distributed/profile.py", line 274, in _watch
    process(frame, None, recent, omit=omit)
  File "/nobackup/amondal/.conda/envs/xmitgcm4/lib/python3.10/site-packages/distributed/profile.py", line 119, in process
    "description": info_frame(frame),
  File "/nobackup/amondal/.conda/envs/xmitgcm4/lib/python3.10/site-packages/distributed/profile.py", line 72, in info_frame
    line = linecache.getline(co.co_filename, frame.f_lineno, frame.f_globals).lstrip()
  File "/nobackup/amondal/.conda/envs/xmitgcm4/lib/python3.10/linecache.py", line 31, in getline
    if 1 <= lineno <= len(lines):
TypeError: '<=' not supported between instances of 'int' and 'NoneType'
Exception in thread Profile:
Traceback (most recent call last):
  File "/nobackup/amondal/.conda/envs/xmitgcm4/lib/python3.10/site-packages/distributed/profile.py", line 115, in process
    d = state["children"][ident]
KeyError: 'transition_released_forgotten;/nobackup/amondal/.conda/envs/xmitgcm4/lib/python3.10/site-packages/distributed/worker.py;2436'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/nobackup/amondal/.conda/envs/xmitgcm4/lib/python3.10/threading.py", line 1009, in _bootstrap_inner
    self.run()
  File "/nobackup/amondal/.conda/envs/xmitgcm4/lib/python3.10/threading.py", line 946, in run
    self._target(*self._args, **self._kwargs)
  File "/nobackup/amondal/.conda/envs/xmitgcm4/lib/python3.10/site-packages/distributed/profile.py", line 274, in _watch
    process(frame, None, recent, omit=omit)
  File "/nobackup/amondal/.conda/envs/xmitgcm4/lib/python3.10/site-packages/distributed/profile.py", line 119, in process
    "description": info_frame(frame),
  File "/nobackup/amondal/.conda/envs/xmitgcm4/lib/python3.10/site-packages/distributed/profile.py", line 72, in info_frame
    line = linecache.getline(co.co_filename, frame.f_lineno, frame.f_globals).lstrip()
  File "/nobackup/amondal/.conda/envs/xmitgcm4/lib/python3.10/linecache.py", line 31, in getline
    if 1 <= lineno <= len(lines):
TypeError: '<=' not supported between instances of 'int' and 'NoneType'
distributed.utils_perf - WARNING - full garbage collections took 10% CPU time recently (threshold: 10%)
distributed.utils_perf - WARNING - full garbage collections took 10% CPU time recently (threshold: 10%)
distributed.utils_perf - WARNING - full garbage collections took 10% CPU time recently (threshold: 10%)
distributed.utils_perf - WARNING - full garbage collections took 10% CPU time recently (threshold: 10%)
Exception in thread Profile:
Traceback (most recent call last):
  File "/nobackup/amondal/.conda/envs/xmitgcm4/lib/python3.10/site-packages/distributed/profile.py", line 115, in process
    d = state["children"][ident]
KeyError: 'transition_generic_released;/nobackup/amondal/.conda/envs/xmitgcm4/lib/python3.10/site-packages/distributed/worker.py;2046'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/nobackup/amondal/.conda/envs/xmitgcm4/lib/python3.10/threading.py", line 1009, in _bootstrap_inner
    self.run()
  File "/nobackup/amondal/.conda/envs/xmitgcm4/lib/python3.10/threading.py", line 946, in run
    self._target(*self._args, **self._kwargs)
  File "/nobackup/amondal/.conda/envs/xmitgcm4/lib/python3.10/site-packages/distributed/profile.py", line 274, in _watch
    process(frame, None, recent, omit=omit)
  File "/nobackup/amondal/.conda/envs/xmitgcm4/lib/python3.10/site-packages/distributed/profile.py", line 119, in process
    "description": info_frame(frame),
  File "/nobackup/amondal/.conda/envs/xmitgcm4/lib/python3.10/site-packages/distributed/profile.py", line 72, in info_frame
    line = linecache.getline(co.co_filename, frame.f_lineno, frame.f_globals).lstrip()
  File "/nobackup/amondal/.conda/envs/xmitgcm4/lib/python3.10/linecache.py", line 31, in getline
    if 1 <= lineno <= len(lines):
TypeError: '<=' not supported between instances of 'int' and 'NoneType'
distributed.utils_perf - WARNING - full garbage collections took 10% CPU time recently (threshold: 10%)
distributed.utils_perf - WARNING - full garbage collections took 10% CPU time recently (threshold: 10%)
distributed.utils_perf - WARNING - full garbage collections took 10% CPU time recently (threshold: 10%)
distributed.utils_perf - WARNING - full garbage collections took 10% CPU time recently (threshold: 10%)
distributed.utils_perf - WARNING - full garbage collections took 10% CPU time recently (threshold: 10%)
distributed.utils_perf - WARNING - full garbage collections took 10% CPU time recently (threshold: 10%)
distributed.utils_perf - WARNING - full garbage collections took 10% CPU time recently (threshold: 10%)
distributed.utils_perf - WARNING - full garbage collections took 10% CPU time recently (threshold: 10%)
distributed.utils_perf - WARNING - full garbage collections took 10% CPU time recently (threshold: 10%)
distributed.utils_perf - WARNING - full garbage collections took 10% CPU time recently (threshold: 10%)
